module.exports=function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="/static/",e(e.s="./src/entries/server/index.ts")}({"./src/entries/server/index.ts":function(t,n,e){"use strict";e.r(n);var r=e("express"),i=e.n(r),o=function(t){return'\n<!doctype html>\n<html>\n\t<head>\n\t\t<meta charset="utf-8" />\n\t\t<title>Планирование</title>\n\t\t<link rel="stylesheet" href="/static/bundle.css" />\n\t\t<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">\n\t\t<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"><\/script>\n\t\t<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"><\/script>\n\t\t<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"><\/script>\n\t</head>\n\t<body>\n\t\t<div id="content"></div>\n\t\t<script>\n\t\t\twindow.__INITIAL_STATE__ = '+JSON.stringify(t)+';\n\t\t<\/script>\n\t\t<script src="/static/bundle.js"><\/script>\n\t</body>\n</html>'},s=e("morgan"),a=e.n(s),u=e("path"),c=e("fs"),f=function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(s,a)}u((r=r.apply(t,n||[])).next())})},l=function(t,n){var e,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(t,s)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},p="../../.plannings/",d=".json";function y(){return f(this,void 0,void 0,function(){return l(this,function(t){return[2,new Promise(function(t,n){c.readdir(Object(u.resolve)(__dirname,p),function(e,r){e?n(e.message):t(r.map(function(t){return Object(u.parse)(t).name}))})})]})})}var b,m,h="/plannings",O=e("encaps"),g=function(){return(g=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},v=Object(O.build)().setInitState(function(){return{id:"",title:""}}).action({setId:function(t,n){return g({},t,{id:n.payload})},setTitle:function(t,n){return g({},t,{title:n.payload})}}),j=(v.reducer,v.actions,v),k=Object(O.createMap)(j),x=k.action({create:function(t){var n=Object.keys(t.items).map(Number).sort(function(t,n){return n-t})[0]+1;return k.reducer(t,k.actions.add(isNaN(n)?"0":n+""))}}),S=function(){return(S=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},w=Object(O.build)().setInitState(function(){return{id:"",title:"",taskId:null,duration:1,start:1}}).action({setId:function(t,n){return S({},t,{id:n.payload})},setTitle:function(t,n){return S({},t,{title:n.payload})},setStart:function(t,n){return S({},t,{start:n.payload})},setDuration:function(t,n){return S({},t,{duration:n.payload})},setPerson:function(t,n){return S({},t,{personId:n.payload})}}),P=(w.reducer,w.actions,w),N=function(){return(N=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},J=Object(O.createMap)(P),_=J.action({create:function(t,n){var e=Object.keys(t.items).map(Number).sort(function(t,n){return n-t})[0]+1,r=isNaN(e)?"0":e+"",i=J.reducer(t,J.actions.add(r));return i.items[r].taskId=n.payload,i},removeByTask:function(t,n){return N({},t,{items:Object.keys(t.items).reduce(function(e,r){var i;return t.items[r].taskId===n.payload?e:N({},e,((i={})[r]=t.items[r],i))},{})})},cleanPerson:function(t,n){return N({},t,{items:Object.keys(t.items).reduce(function(e,r){var i;return N({},e,((i={})[r]=t.items[r].personId===n.payload?N({},t.items[r],{personId:null}):t.items[r],i))},{})})}}),T=function(){return(T=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},q=Object(O.build)().setInitState(function(){return{name:""}}).action({setName:function(t,n){return T({},t,{name:n.payload})}}),I=(q.reducer,q.actions,q),M=Object(O.createMap)(I),C=M.action({create:function(t){var n=Object.keys(t.items).map(Number).sort(function(t,n){return n-t})[0]+1;return M.reducer(t,M.actions.add(isNaN(n)?"0":n+""))}}),E=Object(O.build)().child("tasks",x).child("subTasks",_).child("people",C).subActions({tasks:{remove:function(t,n){return n.subTasks.removeByTask(t)}},people:{remove:function(t,n){return n.subTasks.cleanPerson(t)}}}),U=function(){return(U=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},A=Object(O.build)().setInitState(function(){return{items:[],current:null,loading:!1}}).action(((b={}).add=function(t,n){return U({},t,{items:t.items.concat([n.payload])})},b.remove=function(t,n){return U({},t,{items:t.items.filter(function(t){return t!==n.payload}),current:null})},b.setCurrent=function(t,n){return U({},t,{current:n.payload||null})},b.loaded=function(t,n){return U({},t,{loading:n.payload})},b)),X=function(){return(X=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},Z=(m=Object(O.build)().child("sprint",E).child("sprints",A).action({replace:function(t,n){return X({},t,{sprint:n.payload||E.reducer()})}})).reducer,F=(m.actions,e("body-parser"));var H=e("minimist");!function(t){var n=void 0===t?{}:t,e=n.app,r=void 0===e?i()():e,s=n.port,b=void 0===s?8080:s;r.use("/static",i.a.static(u.resolve(__dirname,"../public/"))),r.use(a()("tiny")),r.use(Object(F.urlencoded)({extended:!1})),r.use(Object(F.json)()),r.post(h,function(t,n){if(n.setHeader("Content-Type","application/json; charset=utf-8"),!t.body.key||!t.body.data)return n.status(422),void n.send(JSON.stringify({status:"no_params"}));(function(t,n){return f(this,void 0,void 0,function(){return l(this,function(e){return[2,new Promise(function(e,r){~t.indexOf(".")||~t.indexOf("/")||~t.indexOf("\\")?r("Unacceptable symbols in key."):c.writeFile(Object(u.resolve)(__dirname,p,t+d),JSON.stringify(n),function(t){t?r(t.message):e()})})]})})})(t.body.key,t.body.data).then(function(){n.send(JSON.stringify({status:"ok"}))}).catch(function(t){n.status(500),n.send(JSON.stringify({status:"error",message:t}))})}),r.get(h,function(t,n){n.setHeader("Content-Type","application/json; charset=utf-8"),t.query.key?function(t){return f(this,void 0,void 0,function(){return l(this,function(n){return[2,new Promise(function(n,e){~t.indexOf(".")||~t.indexOf("/")||~t.indexOf("\\")?e("Unacceptable symbols in key."):c.readFile(Object(u.resolve)(__dirname,p,t+d),{encoding:"utf8"},function(t,r){t?e(t.message):n(JSON.parse(r))})})]})})}(t.query.key).then(function(t){n.send(JSON.stringify(t))}).catch(function(t){n.status(500),n.send(JSON.stringify({status:"error",message:t}))}):y().then(function(t){n.send(JSON.stringify(t))}).catch(function(t){n.status(500),n.send(JSON.stringify({status:"error",message:t}))})}),r.delete(h,function(t,n){if(n.setHeader("Content-Type","application/json; charset=utf-8"),!t.query.key)return n.status(422),void n.send(JSON.stringify({status:"no_params"}));(function(t){return f(this,void 0,void 0,function(){return l(this,function(n){return[2,new Promise(function(n,e){~t.indexOf(".")||~t.indexOf("/")||~t.indexOf("\\")?e("Unacceptable symbols in key."):c.unlink(Object(u.resolve)(__dirname,p,t+d),function(t){t?e(t.message):n()})})]})})})(t.query.key).then(function(){n.send(JSON.stringify({status:"ok"}))}).catch(function(t){n.status(500),n.send(JSON.stringify({status:"error",message:t}))})}),r.get("/",function(t,n){n.setHeader("Content-Type","text/html; charset=utf-8"),y().then(function(t){var e=Z();e.sprints={items:t,current:null,loading:!1},n.send(o(e))}).catch(function(){n.send(o({}))})}),r.use(function(t,n){n.status(404).send("Page not found!"),console.log("Url not found: "+t.url)}),r.use(function(t,n,e,r){console.log(t.stack),e.status(500).send("Something broke!")}),r.listen(b,function(){console.log("The application started on port "+b+".")})}({port:e.n(H)()(process.argv.slice(2)).port})},"body-parser":function(t,n){t.exports=require("body-parser")},encaps:function(t,n){t.exports=require("encaps")},express:function(t,n){t.exports=require("express")},fs:function(t,n){t.exports=require("fs")},minimist:function(t,n){t.exports=require("minimist")},morgan:function(t,n){t.exports=require("morgan")},path:function(t,n){t.exports=require("path")}});
//# sourceMappingURL=index.js.map