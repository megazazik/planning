{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/server/getMarkUp.ts","webpack:///./src/server/storage/index.ts","webpack:///./src/server/routes.ts","webpack:///./src/app/task/index.ts","webpack:///./src/app/taskList/index.ts","webpack:///./src/app/subTask/index.ts","webpack:///./src/app/subTaskList/index.ts","webpack:///./src/app/person/index.ts","webpack:///./src/app/people/index.ts","webpack:///./src/app/sprint/index.ts","webpack:///./src/app/sprints/index.ts","webpack:///./src/app/page/index.ts","webpack:///./src/server/index.ts","webpack:///./src/entries/server/index.ts","webpack:///external \"body-parser\"","webpack:///external \"encaps\"","webpack:///external \"express\"","webpack:///external \"fs\"","webpack:///external \"minimist\"","webpack:///external \"morgan\"","webpack:///external \"path\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","getMarkUp","data","JSON","stringify","PLANNINGS_PATH","FILE_EXTENTION","getAll","Promise","resolse","reject","external_fs_","external_path_","__dirname","err","files","message","map","fileName","PLANNING_API_PATH","model","external_encaps_","setInitState","id","title","action","setId","task","__assign","payload","setTitle","reducer","actions","tasksModelBase","taskList","tasks","newKey","keys","items","Number","sort","a","b","add","isNaN","subTask_model","taskId","duration","start","subTask_assign","setStart","setDuration","setPerson","personId","subTask","subTasksBase","subTaskList","subTasks","newKeyNumber","newSubTasks","removeByTask","subTaskList_assign","reduce","newTasks","subTaskId","_a","cleanPerson","person_model","setName","person","person_assign","peopleModelBase","people","sprint","child","subActions","remove","sprints","current","loading","sprints_a","state","sprints_assign","concat","filter","planning","page_reducer","page_a","_b","_c","app","external_express_default","_d","port","use","static","external_morgan_default","external_body_parser_","extended","post","req","res","setHeader","body","status","send","indexOf","save","then","catch","query","encoding","parse","delete","deleteSpring","_","initState","console","log","url","next","stack","listen","startServer","external_minimist_default","process","argv","slice","require"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/entries/server/index.ts\");\n","export default (data): string => {\n\treturn `\n<!doctype html>\n<html>\n\t<head>\n\t\t<meta charset=\"utf-8\" />\n\t\t<title>Планирование</title>\n\t\t<link rel=\"stylesheet\" href=\"/static/bundle.css\" />\n\t\t<link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css\" integrity=\"sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO\" crossorigin=\"anonymous\">\n\t\t<script src=\"https://code.jquery.com/jquery-3.3.1.slim.min.js\" integrity=\"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo\" crossorigin=\"anonymous\"></script>\n\t\t<script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js\" integrity=\"sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49\" crossorigin=\"anonymous\"></script>\n\t\t<script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js\" integrity=\"sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy\" crossorigin=\"anonymous\"></script>\n\t</head>\n\t<body>\n\t\t<div id=\"content\"></div>\n\t\t<script>\n\t\t\twindow.__INITIAL_STATE__ = ${JSON.stringify(data)};\n\t\t</script>\n\t\t<script src=\"/static/bundle.js\"></script>\n\t</body>\n</html>`;\n};","import { reducer } from '../../app/page';\r\nimport { resolve, parse } from 'path';\r\nimport * as fs from 'fs';\r\n\r\nconst PLANNINGS_PATH = '../../.plannings/';\r\nconst FILE_EXTENTION = '.json';\r\n\r\nexport async function save(key: string, data: ReturnType<typeof reducer>) {\r\n\treturn new Promise((resolse, reject) => {\r\n\t\t/** @todo небезопасно, сделать проверку перед сохранением */\r\n\t\tif (~key.indexOf('.') || ~key.indexOf('/') || ~key.indexOf('\\\\')) {\r\n\t\t\treject('Unacceptable symbols in key.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfs.writeFile(\r\n\t\t\tresolve(__dirname, PLANNINGS_PATH, key + FILE_EXTENTION),\r\n\t\t\tJSON.stringify(data),\r\n\t\t\t(err) => {\r\n\t\t\t\tif (err) {\r\n\t\t\t\t\treject(err.message);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresolse();\r\n\t\t\t}\r\n\t\t);\r\n\t});\r\n}\r\n\r\nexport async function get(key: string) {\r\n\treturn new Promise((resolse, reject) => {\r\n\t\t/** @todo небезопасно, сделать проверку перед сохранением */\r\n\t\tif (~key.indexOf('.') || ~key.indexOf('/') || ~key.indexOf('\\\\')) {\r\n\t\t\treject('Unacceptable symbols in key.');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tfs.readFile(\r\n\t\t\tresolve(__dirname, PLANNINGS_PATH, key + FILE_EXTENTION),\r\n\t\t\t{encoding: 'utf8'},\r\n\t\t\t(err, data) => {\r\n\t\t\t\tif (err) {\r\n\t\t\t\t\treject(err.message);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresolse(JSON.parse(data));\r\n\t\t\t}\r\n\t\t);\r\n\t});\r\n}\r\n\r\nexport async function getAll() {\r\n\treturn new Promise<string[]>((resolse, reject) => {\r\n\t\tfs.readdir(resolve(__dirname, PLANNINGS_PATH), (err, files) => {\r\n\t\t\tif (err) {\r\n\t\t\t\treject(err.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tresolse(files.map((fileName) => parse(fileName).name));\r\n\t\t});\r\n\t});\r\n}\r\n\r\n\r\nexport async function deleteSpring(key: string) {\r\n\treturn new Promise((resolse, reject) => {\r\n\t\t/** @todo небезопасно, сделать проверку перед сохранением */\r\n\t\tif (~key.indexOf('.') || ~key.indexOf('/') || ~key.indexOf('\\\\')) {\r\n\t\t\treject('Unacceptable symbols in key.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfs.unlink(\r\n\t\t\tresolve(__dirname, PLANNINGS_PATH, key + FILE_EXTENTION),\r\n\t\t\t(err) => {\r\n\t\t\t\tif (err) {\r\n\t\t\t\t\treject(err.message);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresolse();\r\n\t\t\t}\r\n\t\t);\r\n\t});\r\n}","export const PLANNING_API_PATH = '/plannings';","import { build, IAction } from 'encaps';\r\n\r\nexport interface ITask {\r\n\tid: string;\r\n\ttitle: string;\r\n}\r\n\r\nconst model = build()\r\n.setInitState<ITask>(() => ({\r\n\tid: '',\r\n\ttitle: ''\r\n}))\r\n.action({\r\n\tsetId: (task, action: IAction<string>) => ({...task, id: action.payload}),\r\n\tsetTitle: (task, action: IAction<string>) => ({...task, title: action.payload}),\r\n});\r\n\r\nexport const { reducer, actions } = model;\r\nexport default model;","import { createMap, IAction } from 'encaps';\r\nimport task from '../task';\r\n\r\nconst tasksModelBase = createMap(task);\r\nconst tasksModel = tasksModelBase\r\n\t.action({\r\n\t\tcreate: (tasks) => {\r\n\t\t\tconst newKey = Object.keys(tasks.items).map(Number).sort((a, b) => b - a)[0] + 1;\r\n\t\t\treturn tasksModelBase.reducer(\r\n\t\t\t\ttasks,\r\n\t\t\t\ttasksModelBase.actions.add(isNaN(newKey) ? '0' : newKey + '')\r\n\t\t\t);;\r\n\t\t},\r\n\t});\r\n\r\nexport default tasksModel;","import { build, IAction } from 'encaps';\r\n\r\nexport interface ISubTask {\r\n\tid: string;\r\n\ttitle: string;\r\n\tstart?: number;\r\n\tduration?: number;\r\n\ttaskId: string;\r\n\tpersonId?: string;\r\n}\r\n\r\nconst model = build()\r\n\t.setInitState<ISubTask>(() => ({\r\n\t\tid: '',\r\n\t\ttitle: '',\r\n\t\ttaskId: null,\r\n\t\tduration: 1,\r\n\t\tstart: 1,\r\n\t}))\r\n\t.action({\r\n\t\tsetId: (task, action: IAction<string>) => ({...task, id: action.payload}),\r\n\t\tsetTitle: (task, action: IAction<string>) => ({...task, title: action.payload}),\r\n\t\tsetStart: (task, action: IAction<number>) => ({\r\n\t\t\t...task, \r\n\t\t\tstart: action.payload,\r\n\t\t}),\r\n\t\tsetDuration: (task, action: IAction<number>) => ({\r\n\t\t\t...task,\r\n\t\t\tduration: action.payload,\r\n\t\t}),\r\n\t\tsetPerson: (task, action: IAction<string>) => ({\r\n\t\t\t...task,\r\n\t\t\tpersonId: action.payload,\r\n\t\t}),\r\n\t});\r\n\r\nexport const { reducer, actions } = model;\r\nexport default model;","import { createMap, IAction } from 'encaps';\r\nimport subTask from '../subTask';\r\nimport { filter } from './filter';\r\n\r\nconst subTasksBase = createMap(subTask);\r\nconst subTasks = subTasksBase\r\n\t.action({\r\n\t\tcreate: (subTasks, action: IAction<string>) => {\r\n\t\t\tconst newKeyNumber = Object.keys(subTasks.items).map(Number).sort((a, b) => b - a)[0] + 1;\r\n\t\t\tconst newKey = isNaN(newKeyNumber) ? '0' : newKeyNumber + ''\r\n\t\t\tconst newSubTasks = subTasksBase.reducer(\r\n\t\t\t\tsubTasks,\r\n\t\t\t\tsubTasksBase.actions.add(newKey)\r\n\t\t\t);\r\n\t\t\tnewSubTasks.items[newKey].taskId = action.payload;\r\n\t\t\treturn newSubTasks;\r\n\t\t},\r\n\t\tremoveByTask(subTasks, action: IAction<string>) {\r\n\t\t\treturn {\r\n\t\t\t\t...subTasks,\r\n\t\t\t\titems: Object.keys(subTasks.items).reduce(\r\n\t\t\t\t\t(newTasks, subTaskId) => subTasks.items[subTaskId].taskId === action.payload\r\n\t\t\t\t\t\t? newTasks\r\n\t\t\t\t\t\t: {\r\n\t\t\t\t\t\t\t...newTasks,\r\n\t\t\t\t\t\t\t[subTaskId]: subTasks.items[subTaskId],\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t{}\r\n\t\t\t\t)\r\n\t\t\t};\r\n\t\t},\r\n\t\tcleanPerson(subTasks, action: IAction<string>) {\r\n\t\t\treturn {\r\n\t\t\t\t...subTasks,\r\n\t\t\t\titems: Object.keys(subTasks.items).reduce(\r\n\t\t\t\t\t(newTasks, subTaskId) => ({\r\n\t\t\t\t\t\t...newTasks,\r\n\t\t\t\t\t\t[subTaskId]: subTasks.items[subTaskId].personId === action.payload\r\n\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t...subTasks.items[subTaskId],\r\n\t\t\t\t\t\t\t\tpersonId: null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t: subTasks.items[subTaskId],\t\r\n\t\t\t\t\t}),\r\n\t\t\t\t\t{}\r\n\t\t\t\t)\r\n\t\t\t};\r\n\t\t},\r\n\t});\r\n\r\nexport default subTasks;\r\n","import { build, IAction } from 'encaps';\r\n\r\nexport interface IPerson {\r\n\tname: string;\r\n}\r\n\r\nconst model = build()\r\n\t.setInitState<IPerson>(() => ({\r\n\t\tname: '',\r\n\t}))\r\n\t.action({\r\n\t\tsetName: (person, action: IAction<string>) => ({...person, name: action.payload}),\r\n\t});\r\n\r\nexport const { reducer, actions } = model;\r\nexport default model;","import { createMap } from 'encaps';\r\nimport person from '../person';\r\n\r\nconst peopleModelBase = createMap(person);\r\nconst peopleModel = peopleModelBase\r\n\t.action({\r\n\t\tcreate: (people) => {\r\n\t\t\tconst newKey = Object.keys(people.items).map(Number).sort((a, b) => b - a)[0] + 1;\r\n\t\t\treturn peopleModelBase.reducer(\r\n\t\t\t\tpeople,\r\n\t\t\t\tpeopleModelBase.actions.add(isNaN(newKey) ? '0' : newKey + '')\r\n\t\t\t);;\r\n\t\t},\r\n\t});\r\n\r\nexport default peopleModel;","import { build } from 'encaps';\r\nimport tasks from '../taskList';\r\nimport subTasksLists from '../subTaskList';\r\nimport people from '../people';\r\n\r\nexport const model = build()\r\n\t.child('tasks', tasks)\r\n\t.child('subTasks', subTasksLists)\r\n\t.child('people', people)\r\n\t.subActions({\r\n\t\ttasks: {\r\n\t\t\tremove: (payload, actions) => actions.subTasks.removeByTask(payload)\r\n\t\t},\r\n\t\tpeople: {\r\n\t\t\tremove: (payload, actions) => actions.subTasks.cleanPerson(payload)\r\n\t\t}\r\n\t});\r\n\r\nexport default model;","import { build, IAction } from 'encaps';\r\n\r\nexport interface ISprints {\r\n\titems: string[];\r\n\tcurrent: string;\r\n\tloading: boolean;\r\n}\r\n\r\nexport const SET_CURRENT = 'setCurrent',\r\n\tLOADED = 'loaded',\r\n\tADD = 'add',\r\n\tREMOVE = 'remove';\r\n\r\nconst model = build()\r\n\t.setInitState<ISprints>(() => ({\r\n\t\titems: [],\r\n\t\tcurrent: null,\r\n\t\tloading: false,\r\n\t}))\r\n\t.action({\r\n\t\t[ADD]: (state, action: IAction<string>) => ({\r\n\t\t\t...state,\r\n\t\t\titems: [...state.items, action.payload]\r\n\t\t}),\r\n\t\t[REMOVE]: (state, action: IAction<string>) => ({\r\n\t\t\t...state,\r\n\t\t\titems: state.items.filter((planning) => (planning !== action.payload)),\r\n\t\t\tcurrent: null,\r\n\t\t}),\r\n\t\t[SET_CURRENT]: (state, action: IAction<string>) => ({\r\n\t\t\t...state,\r\n\t\t\tcurrent: action.payload || null,\r\n\t\t}),\r\n\t\t[LOADED]: (state, action: IAction<boolean>) => ({...state, loading: action.payload}),\r\n\t});\r\n\r\nexport default model;","import { build, IAction } from 'encaps';\r\nimport sprint from '../sprint';\r\nimport sprints from '../sprints';\r\nimport { ModelState } from '../../modules/model';\r\n\r\nexport const SPRINTS_KEY = 'sprints';\r\n\r\nexport const { reducer, actions } = build()\r\n\t.child('sprint', sprint)\r\n\t.child(SPRINTS_KEY, sprints)\r\n\t.action({\r\n\t\treplace: (state, action: IAction<ModelState<typeof sprint>>) => ({\r\n\t\t\t...state,\r\n\t\t\tsprint: action.payload || sprint.reducer()\r\n\t\t})\r\n\t});\r\n","import express from 'express';\nimport getHtml from './getMarkUp';\nimport morgan from 'morgan';\nimport * as path from 'path';\nimport * as storage from './storage';\nimport { PLANNING_API_PATH } from './routes';\nimport { reducer } from '../app/page';\nimport { json, urlencoded } from 'body-parser';\n\nexport interface IParams {\n\tport?: number;\n\tapp?: ReturnType<typeof express>;\n}\n\nexport default function startServer({app = express(), port = 8080}: IParams = {}) {\n\t/** @todo разобраться с относительными путями, если нужно */\n\tapp.use('/static', express.static(path.resolve(__dirname, '../public/')));\n\n\tapp.use(morgan('tiny'));\n\n\tapp.use(urlencoded({extended: false}));\n\tapp.use(json());\n\n\tapp.post(PLANNING_API_PATH, (req, res) => {\n\t\tres.setHeader(\"Content-Type\", \"application/json; charset=utf-8\");\n\t\tif (!req.body.key || !req.body.data) {\n\t\t\tres.status(422);\n\t\t\tres.send(JSON.stringify({status: 'no_params'}));\n\t\t\treturn;\n\t\t}\n\n\t\tstorage.save(req.body.key, req.body.data)\n\t\t\t.then(() => {res.send(JSON.stringify({status: 'ok'}))})\n\t\t\t.catch((message) => {\n\t\t\t\tres.status(500);\n\t\t\t\tres.send(JSON.stringify({status: 'error', message}));\n\t\t\t});\n\t});\n\n\tapp.get(PLANNING_API_PATH, (req, res) => {\n\t\tres.setHeader(\"Content-Type\", \"application/json; charset=utf-8\");\n\t\tif (!req.query.key) {\n\t\t\tstorage.getAll()\n\t\t\t\t.then((data) => {res.send(JSON.stringify(data))})\n\t\t\t\t.catch((message) => {\n\t\t\t\t\tres.status(500);\n\t\t\t\t\tres.send(JSON.stringify({status: 'error', message}));\n\t\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tstorage.get(req.query.key)\n\t\t\t.then((data) => {res.send(JSON.stringify(data))})\n\t\t\t.catch((message) => {\n\t\t\t\tres.status(500);\n\t\t\t\tres.send(JSON.stringify({status: 'error', message}));\n\t\t\t});\n\t});\n\t\n\tapp.delete(PLANNING_API_PATH, (req, res) => {\n\t\tres.setHeader(\"Content-Type\", \"application/json; charset=utf-8\");\n\t\tif (!req.query.key) {\n\t\t\tres.status(422);\n\t\t\tres.send(JSON.stringify({status: 'no_params'}));\n\t\t\treturn;\n\t\t}\n\n\t\tstorage.deleteSpring(req.query.key)\n\t\t\t.then(() => {res.send(JSON.stringify({status: 'ok'}))})\n\t\t\t.catch((message) => {\n\t\t\t\tres.status(500);\n\t\t\t\tres.send(JSON.stringify({status: 'error', message}));\n\t\t\t});\n\t});\n\n\tapp.get('/', (_, res) => {\n\t\tres.setHeader(\"Content-Type\", \"text/html; charset=utf-8\");\n\t\tstorage.getAll()\n\t\t\t.then((data) => {\n\t\t\t\tconst initState = reducer();\n\t\t\t\tinitState.sprints = {\n\t\t\t\t\titems: data,\n\t\t\t\t\tcurrent: null,\n\t\t\t\t\tloading: false,\n\t\t\t\t}\n\t\t\t\tres.send(getHtml(initState));\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tres.send(getHtml({}));\n\t\t\t});\n\t});\n\n\tapp.use(function(req, res) {\n\t\tres.status(404).send('Page not found!');\n\t\tconsole.log('Url not found: ' + req.url);\n\t});\n\n\tapp.use(function(err, req, res, next) {\n\t\tconsole.log(err.stack);\n\t\tres.status(500).send('Something broke!');\n\t});\n\n\tapp.listen(port, () => {\n\t\tconsole.log(`The application started on port ${port}.`);\n\t});\n}","import startServer from '../../server';\nimport pargeArgs from 'minimist';\n\nconst params = pargeArgs(process.argv.slice(2));\nstartServer({port: params.port});","module.exports = require(\"body-parser\");","module.exports = require(\"encaps\");","module.exports = require(\"express\");","module.exports = require(\"fs\");","module.exports = require(\"minimist\");","module.exports = require(\"morgan\");","module.exports = require(\"path\");"],"sourceRoot":""}